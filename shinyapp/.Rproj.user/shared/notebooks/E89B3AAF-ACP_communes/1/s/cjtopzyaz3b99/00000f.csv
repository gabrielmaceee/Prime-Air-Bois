"0","data_acp <- data[,c(1,43)] %>% group_by(insee_com) %>% count()"
"0",""
"0","#quanti = c(""cout_total_TTC"", ""montant_aide"",""cout_appareil"") # , ""équivalent_steres"""
"0","quali = c(""Type.Ancien.appareil"", ""Usage.ancien.matériel"",  ""Nouveau.matériel"",""Type.combustible.nouveau.materiel"", ""Usage.nouveau.matériel"", ""majoration"""
"0","          )"
"0","#  ""Année.installation"","
"0","for(col in quali){"
"0","df_long <- data[,c(col, ""insee_com"")]"
"0","df_long <- dummy_cols(df_long, select_columns = col, remove_first_dummy = FALSE, remove_selected_columns = TRUE)"
"0","df_binary <- df_long %>%"
"0","    group_by(`insee_com`) %>% summarise(across(everything(), sum , na.rm = TRUE)) "
"0","data_acp <- left_join(data_acp, df_binary, by = ""insee_com"")"
"0","}"
"0",""
"0","df <- data[,c(""insee_com"",""cout_total_TTC"")] %>% group_by(`insee_com`) %>% summarise(cout_total_TTC = mean(na.omit(cout_total_TTC)))"
"0","data_acp <- left_join(data_acp, df, by = ""insee_com"")"
"0",""
"0","df <- data[,c(""insee_com"",""montant_aide"")] %>% group_by(`insee_com`) %>% summarise(montant_aide = mean(na.omit(montant_aide)))"
"0","data_acp <- left_join(data_acp, df, by = ""insee_com"")"
"0",""
"0","binaire2 <- binaire %>% group_by(`insee_com`) %>% summarise(across(everything(), sum , na.rm = TRUE)) "
"0","data_acp <- left_join(data_acp, binaire2, by = ""insee_com"")"
"0",""
"0","for(i in setdiff(names(data_acp), c(""insee_com"", ""n"", ""montant_aide""))){"
"0","  data_acp[,i] = data_acp[,i] / data_acp$n"
"0","}"
"0","terr = data[,c(""Territoire"",""insee_com"")]"
"0","terr = terr[!duplicated(terr$insee_com),]"
"0","data_acp <- left_join(data_acp, terr, by = ""insee_com"")"
