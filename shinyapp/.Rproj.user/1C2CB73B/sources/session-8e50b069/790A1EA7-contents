# This is the server logic of a Shiny web application. You can run the
# application by clicking 'Run App' above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
#




# Define server logic required to draw a histogram
shinyServer(function(input, output) {

    output$distPlot <- renderPlot({
        
        territoire_name <- input$un_territoire
        column_name <- column_names[column_names$name == input$column_name,]$id
        
        if(territoire_name == "Tous"){filter_data <- data}
        else{filter_data <- data %>%
          filter(territoire == territoire_name)}
        couleur = couleur_terr %>% filter(territoire == territoire_name)
          get_graph(filter_data, column_name, couleur$couleur)
    })
    output$cartographie <- renderLeaflet({
      carto()
      })

})



